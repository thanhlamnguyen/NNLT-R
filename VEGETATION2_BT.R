setwd("F:/R")
data <- read.table("Vegetation2.txt", header = TRUE)
names(data)
str(data)
#Bi???n d???ng c??? grassland t??? c???t th??? 2 dên 13 trong bi???n data
grassland <- data[,2:13]
names(grassland)
str(grassland)
#Ki???m tra dimesions - chi???u c???a bi???n grassland
n <- dim(grassland)
n # có 58 dòng và 12 c???t
# 45 dòng -  tuong ???ng v???i 45 sites - v??? trí thu nh???p m???u v???t
#Tuong ???ng v???i m???i v??? trí thì s??? ghi nh???n du???c nh???ng d???ng c??? nào
#Có bao nhiêu d???ng c??? ??? v??? trí s??? 1
sum(grassland[1,], na.rm = TRUE) # có 2321.74 d???ng có xu???t hi???n ??? site #1
#Có bao nhiêu d???ng c??? ??? v??? trí s??? 2
sum(grassland[2,], na.rm = TRUE) # có 2403.12 d???ng c??? xu???t hi???n ??? site #2
#... Làm 58 l???n d??? ki???m tra s??? lu???ng d???ng c??? xu???t hi???n t???i các Sites
TA <- vector(length = n[1])
for (i in 1:n[1]) {
  TA[i] <- sum(grassland[i,], na.rm = TRUE)
}
TA
#Use hàm rowSums d??? tính t???ng các c???t trong 1 hàng
TA02 <- rowSums(grassland, na.rm = TRUE)
TA02
#Di vào chi ti???t t???a t???ng v??? trí quan sát
sum(grassland[1,]>0, na.rm = TRUE) #k???t qu??? chúng ta có 11 d???ng c??? khác nhau xu???t hi???n t???i v??? trí 1
Richness <- vector(length = n[1])
for (i in 1:n[1]) {
  Richness[1] <- sum(grassland[1,]>0, na.rm = TRUE)
  
}
Richness

Richness02 <- rowSums(grassland>0, na.rm = TRUE)
Richness02
#Tính ch??? s??? da d???ng d???ng c???
RS <- rowSums(grassland, na.rm = TRUE)
prop <- grassland/RS
H <- rowSums(prop * log10(prop), na.rm = TRUE)
H
#K???t h???p l???i h???t nh???ng gì dã là vô 1 hàm c???a riêng mình 
Index.function <- function(grass, Choice){
if (Choice=="Richness"){
  Index <- rowSums(grassland>0, na.rm = TRUE)
}

if (Choice=="Total Abundance"){
  Index <- rowSums(grassland, na.rm = TRUE)
}

if (Choice=="Shannon"){
  RS <- rowSums(grassland, na.rm = TRUE)
  prop <- Species/RS
  Index <- rowSums(prop * log10(prop), na.rm = TRUE)
}
list(Index=Index, MyChoice=Choice)
}
Index.function(grassland,"Shannon")