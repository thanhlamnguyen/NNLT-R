setwd("F:/R")
Benthic <- read.table("RIKZ.txt", header = TRUE)
names(Benthic)
str(Benthic)
#Bi???n loài Species t??? c???t th??? 2 d???n 76 trong bi???n Benthic
Species <- Benthic[,2:76]
names(Species)
str(Species)
#Ki???m tra dimesions - chi???u c???a bi???n Species
n <- dim(Species)
n #có 45 dòng và 75 c???t
# 45 dòng -  tuong ???ng v???i 45 sites - v??? trí thu nh???p m???u v???t
#Tuong ???ng v???i m???i v??? trí thì s??? ghi nh???n du???c nh???ng loài sinh v???t bi???n nào
#Có bao nhiêu loài sinh v???t bi???n ??? v??? trí s??? 1
sum(Species[1,], na.rm = TRUE)
#K???t qu??? 143 loài sinh v???t bi???n xu???t hi???n ??? site #1
sum(Species[2,], na.rm = TRUE)
#... Làm 45 l???n d??? ki???m tra s??? lu???ng sinh v???t bi???n xu???t hi???n t???i các Sites
TA <- vector(length = n[1])
for (i in 1:n[1]) {
  TA[i] <- sum(Species[i,], na.rm = TRUE)
}
TA
#Hàm rowSums: tính t???ng c???a các c???t ??? trong hàng 
#tham s??? na.rm=TRUE => Lo???i b??? các giá tr??? tr???ng
TA02 <- rowSums(Species, na.rm = TRUE)
TA02
#Di vào chi ti???t t???a t???ng v??? trí quan sát
sum(Species[1,]>0, na.rm = TRUE)
#K???t qu??? chúng ta có 11 loài khác nhau xu???t hi???n t???i v??? trí 1
Richness <- vector(length = n[1])
for (i in 1:n[1]) {
  Richness[1] <- sum(Species[1,]>0, na.rm = TRUE)
  
}
Richness

Richness02 <- rowSums(Species>0, na.rm = TRUE)
Richness02

#Ch??? s??? da d???ng loài
#https://en.wikipedia.org/wiki/Diversity_index
#tìm hi???u cách tính ch??? s??? da d???ng loài
#H - sum bi???n ch???y t??? i -> m c???a bieebs p: xác su???t * log10p
RS <- rowSums(Species, na.rm = TRUE)
prop <- Species/RS
H <- rowSums(prop * log10(prop), na.rm = TRUE)
H
#K???t h???p l???i h???t nh???ng gì dã là vô 1 hàm c???a riêng mình 
#Sau này s??? d???ng l???i d??? phân tích nh???ng d??? li???u tuong t???
Index.function <- function(Spec, Choice){
  if (Choice=="Richness"){
    Index <- rowSums(Species>0, na.rm = TRUE)
  }
  
  if (Choice=="Total Abundance"){
    Index <- rowSums(Species, na.rm = TRUE)
  }
  
  if (Choice=="Shannon"){
    RS <- rowSums(Species, na.rm = TRUE)
    prop <- Species/RS
    Index <- rowSums(prop * log10(prop), na.rm = TRUE)
  }
  list(Index=Index, MyChoice=Choice)
}
Index.function(Species,"Shannon")


